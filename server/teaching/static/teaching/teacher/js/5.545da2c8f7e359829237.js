webpackJsonp([5],{"6DQk":function(t,s){},dgVT:function(t,s){},hmgo:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("Dd8w"),i=e.n(a),n=e("qpNt"),o=e("DQny"),c=e("H9my"),l={name:"TableComponent",props:["oid","cid","lid","organization","course","lesson","gcid"],data:function(){return{range:4,table:[],stage:[],stages:[],current:0,gsids:[],games:[],max:0}},methods:{getDisable:function(t){return!t&&0!==t},getColor:function(t){if(t){var s="";return 1*(t*=1)==100?s="success":t>0&&t<100?s="warning":0===t&&(s="fail"),"btn-"+s}},getScoreList:function(t,s,e){var a=this;t<=0||s<=0||c.a.send({url:"ScoreList",data:{oid:s,gcid:t}}).success(function(t){a.table=a.formatData(t,e)}).fail(function(t){}).default(function(){o.a.api=!1})},formatData:function(t,s){var e={},a=[],n=s.homework,o={},c={};this.max=t.stage.length>this.max?t.stage.length:this.max,this.range=this.max>4?4:this.max;var l=[],r=[];t.stage.forEach(function(t){l.push(t.name),r.push(t.gsid)}),this.gsids=r,this.stages=l,t.score.forEach(function(t){t.sid in o||(o[t.sid]={}),t.stage.id in c||(c[t.stage.id]=t.stage.name),o[t.sid][t.stage.id]=t.high_score});var d=function(s){var a=o[s];e[s]=[],t.stage.forEach(function(t){e[s][t.gsid]=a[t.gsid]})};for(var u in o)d(u);return console.log(e),t.student.forEach(function(t){var s=i()({},t.studentDetail,{student:t.student,hid:n}),o=[];(e[t.student]||[]).forEach(function(t,s){o.push(t)}),s.score=o,a.push(s)}),a},rightMove:function(){this.max>4&&this.current+this.range<this.max&&(this.current+=1)},leftMove:function(){this.current>0&&(this.current-=1)},openDetail:function(t){t=i()({},t,{gcid:this.gcid,organization:this.organization,course:this.course,lesson:this.lesson,component:"summary",gsid:this.gsids,stage:this.stages,games:this.games}),n.a.detail=t,o.a.detail="code"},showCode:function(t,s){s=i()({},s,{organization:this.organization,course:this.course,lesson:this.lesson,gsid:this.gsids[this.current+t-1],component:"code"}),n.a.detail=s,o.a.detail="code"}}},r={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("section",{staticClass:"table"},[e("table",{staticClass:"table-header table-reset"},[e("tr",[e("th",{staticClass:"table-70"},[t._v("操作")]),t._v(" "),e("th",{staticClass:"table-70"},[t._v("序号")]),t._v(" "),e("th",{staticClass:"table-70"},[t._v("姓名")]),t._v(" "),t._l(t.range,function(s,a){return e("th",{key:a,staticClass:"table-100"},[e("p",[t._v(t._s(t.stages[t.current+a]))]),t._v(" "),0==a?e("div",{staticClass:"arrow-left",on:{click:t.leftMove}}):t._e(),t._v(" "),a==t.range-1?e("div",{staticClass:"arrow-right",on:{click:t.rightMove}}):t._e()])})],2)]),t._v(" "),e("div",{staticClass:"table-content"},[e("table",{staticClass:"table-reset"},t._l(t.table,function(s,a){return e("tr",{key:a},[e("td",{staticClass:"table-70"},[e("button",{staticClass:"content-show-detail",on:{click:function(e){t.openDetail(s)}}},[t._v("详情")])]),t._v(" "),e("td",{staticClass:"table-70"},[t._v(t._s(a+1))]),t._v(" "),e("td",{staticClass:"table-70"},[t._v(t._s(s.name))]),t._v(" "),t._l(t.range,function(a){return e("td",{key:a,staticClass:"table-100"},[e("button",{staticClass:"content-btn",class:t.getColor(s.score[t.current+a-1]),attrs:{disabled:t.getDisable(s.score[t.current+a-1])},on:{click:function(e){t.showCode(a,s)}}},[t._v(t._s(s.score[t.current+a-1]))])])})],2)}),0)])])},staticRenderFns:[]};var d=e("VU/8")(l,r,!1,function(t){e("dgVT")},"data-v-491d4ca4",null).exports,u=e("Zbsp"),h=e("BRoD"),g={name:"ScoreComponent",data:function(){return{current:-1,chapters:[],oid:0,cid:0,lid:0,gcid:0,organization:"选择班级",course:"选择课程",lesson:"选择课时"}},components:{SeparatorComponent:e("ALMI").a,TableComponent:d},mounted:function(){h.a.logout()},methods:{selectLesson:function(){this.cid<=0?alert("请选择课程"):(n.a.modal=this.cid,o.a.modal="lesson-select")},selectCourse:function(){this.oid<=0?alert("请选择班级"):o.a.modal="course-select"},selectClass:function(){o.a.modal="class-select"},getChapters:function(){var t=this;0!==this.oid&&0!==this.cid&&0!==this.lid&&c.a.send({url:"QuestionList",data:{oid:this.oid,lid:this.lid}}).success(function(s){t.chapters=s}).fail(function(t){}).default(function(){o.a.api=!1})},queryStage:function(t,s){this.current=s,this.gcid=t.gcid,this.$refs.table.getScoreList(this.gcid,this.oid,t)}},watch:{"$store.state.modal":function(t,s){"course-select"===s&&!1===t&&n.a.modal?(this.course=n.a.modal.name+"（"+u.a.language[n.a.modal.language]+"，"+u.a.rank[n.a.modal.grade]+"）",this.cid=i()({},n.a.modal).cid,n.a.modal=!1):"class-select"===s&&!1===t&&n.a.modal?(this.organization=n.a.modal.name+"（"+n.a.modal.manager.name+" "+n.a.modal.manager.phone+"）",this.oid=i()({},n.a.modal).oid,n.a.modal=!1):"lesson-select"===s&&!1===t&&n.a.modal&&"lid"in n.a.modal&&(this.lesson=n.a.modal.name,this.lid=i()({},n.a.modal).lid,n.a.modal=!1)},oid:function(){this.getChapters()},cid:function(){this.getChapters()},lid:function(){this.getChapters()}}},f={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("section",{staticClass:"score"},[e("div",{staticClass:"score-nav"},[e("div",{staticClass:"nav-select"},[e("div",{staticClass:"select-item fl",on:{click:t.selectClass}},[t._v(t._s(t.organization))]),t._v(" "),e("div",{staticClass:"select-item fl",on:{click:t.selectCourse}},[t._v(t._s(t.course))]),t._v(" "),e("div",{staticClass:"select-item fl",on:{click:t.selectLesson}},[t._v(t._s(t.lesson))])])]),t._v(" "),e("div",{staticClass:"score-chapters"},t._l(t.chapters,function(s,a){return e("div",{key:a,staticClass:"chapters-item fl",class:{selected:t.current==a},on:{click:function(e){t.queryStage(s,a)}}},[t._v(t._s(s.detail.chapter))])}),0),t._v(" "),e("TableComponent",{ref:"table",attrs:{oid:t.oid,cid:t.cid,lid:t.lid,organization:t.organization,course:t.course,lesson:t.lesson,gcid:t.gcid}})],1)},staticRenderFns:[]};var m=e("VU/8")(g,f,!1,function(t){e("6DQk")},"data-v-9cac686c",null);s.default=m.exports}});